<!doctype html>
<head>
<meta charset="utf-8">
<title>click page to navigate</title>
</head>
<body>
<script>

function navigate(url, popping) {
  console.log('navigating to %s', url);

  document.body.innerHTML = url;

  if (!popping) {
    window.history.pushState({path: url}, document.title, url);
  }
}

window.addEventListener('popstate', function (e) {
  if (!e.state || !e.state.path) {
    return;
  }
  navigate(e.state.path, true);
});


window.addEventListener('click', function () {
  navigate('/lol');
});

function getPath() {
  return window.location.pathname + window.location.search + window.location.hash;
}

var path = getPath();

document.body.innerHTML = path;
window.history.replaceState({path: path}, document.title, document.location.href);

</script>
</body>
</html>
